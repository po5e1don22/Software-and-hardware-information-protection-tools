**Что из себя представляют решения класса NGFW**

Межсетевые экраны нового поколения — платформы для обеспечения сетевой безопасности, включающие несколько параллельно работающих модулей. Для каждой технологии есть свои [правила](https://rt-solar.ru/products/solar_ngfw/blog/3921/), согласно которым инструменты выполняют свои функции. То есть трафик одновременно анализируется межсетевым экраном, антивирусом, системами глубокого анализа и предотвращения вторжений.

Если исходящие и входящие пакеты данных отвечают принятым в компании регламентам, NGFW допускает обмен между внутренней сетью и внешней. Если нет — блокирует трафик и оповещает ответственных лиц о нарушениях.

Существует три варианта использования решений класса NGFW:

- Защита периметра внутренней сети. Это самый распространенный и универсальный сценарий работы Next Generation Firewall. В его рамках межсетевой экран нового поколения и модули, реализованные в нем, призваны фильтровать весь трафик, циркулирующий между локальной и глобальной сетями. При этом средство защиты руководствуется общими политиками безопасности, на соответствие которым проверяются все пакеты данных.
- Разделение локальной сети на отдельные охраняемые сегменты. Этот сценарий подразумевает усиленную защиту узлов, где обрабатывается критически важная для компании информация, внутренних сервисов, структурных подразделений. Для каждого конкретного сегмента будут применяться свои политики безопасности и правила фильтрации.
- Аутентификация внешних и внутренних пользователей. Решения класса NGFW могут проверять данные отправителей и получателей пакетов, тем самым подтверждая их личность. Эта функция позволяет работать с детальными настройками политик безопасности для управления доступом к внутренним и внешним ресурсам.

Продукты Next Generation Firewall используются в качестве ключевых инструментов защиты от сетевых атак. Они позволяют обеспечить комплексный подход к обеспечению безопасности локальных сетей и обрабатываемых данных.

**Механизмы защиты, реализованные в решениях NGFW**

Функции NGFW следует рассматривать в контексте модулей, реализованных в файрволах нового поколения. Основные технологии и их задачи:

- Межсетевой экран, firewall — модуль, который осуществляет фильтрацию входящих и исходящих пакетов на предмет соответствия внутренним регламентам безопасности. Принцип его работы зависит от настроек, например, файрвол может пропускать любые данные, которые явно не запрещены. И наоборот — запрещать все, что не разрешено.

- [IPS](https://rt-solar.ru/products/solar_ngfw/blog/3953/) — система Intrusion Prevention System, которая позволяет обнаруживать подозрительную активность и препятствовать вторжениям злоумышленников. Она может фильтровать трафик по аномалиям и сигнатурам атак. Технология работает в реальном времени, что дает возможность оперативно отслеживать признаки атак и принимать превентивные меры по их предотвращению.

 **Контроль приложений (App Control)** - МЭ способен распознавать и контролировать конкретные приложения, работающие поверх одного и того же протокола. Например, обычный порт 443 может использоваться как для Google Chrome, так и для Telegram или Tor.

App Control позволяет:

1. Разрешить одни приложения (например, корпоративные мессенджеры), блокировать другие (соцсети, торренты).
2. Применять политики с учётом бизнес-логики.
3. Предотвращать использование теневых (неавторизованных) приложений.

Контроль пользователей (User-ID) - Классические файрволы не знали, _кто_ стоит за IP-адресом. NGFW интегрируется с системами учётных записей (например, Active Directory), чтобы понимать:

1. Какой пользователь инициирует соединение.
2. К каким приложениям и сайтам он обращается.
3. Какие действия предпринимает в сети.

Интеграция с системами анализа угроз (Threat Intelligence) - NGFW получают информацию из внешних источников Threat Intelligence. **Это сервисы, базы данных, которые собирают, анализируют, предоставляют актуальную информацию об угрозах в киберпространстве.**

Проще говоря, это как новостная лента для систем безопасности: они «читают», что происходит в мире атак, и помогают защитным системам заранее знать, какие IP-адреса опасны, какие домены используют в фишинге, какие уязвимости сейчас активно эксплуатируют хакеры.

Примеры того, что входит в Threat Intelligence:

- **списки вредоносных** IP-адресов, доменов
- **индикаторы компрометации** (IoC) — например, хэши вредоносных файлов
- **поведенческие паттерны** атак (тактики, техники, например, из базы MITRE ATT&CK)
- **географические и отраслевые отчёты** по текущим киберугрозам

Подключённый к TI-платформе NGFW способен:

1. Автоматически блокировать известные вредоносные источники.
2. Реагировать быстрее на новые атаки.
3. Обогащать логи и отчёты контекстом: «этот IP был замечен в ботнетах».

Источники бывают:

- коммерческие: Kaspersky Threat Data Feeds, IBM X-Force, Group-IB, Positive Technologies
- открытые: AbuseIPDB, MISP, AlienVault OTX

 Работа с зашифрованным трафиком (SSL/TLS inspection) - Сегодня до 90% интернет-трафика идёт по шифрованным протоколам. NGFW умеет их расшифровывать (SSL Inspection):

- отслеживает содержимое HTTPS-соединений
- обнаруживает вредоносный код внутри защищённых каналов
- проверяет сертификаты, предотвращает MITM-атаки.

- VPN — технология Virtual Private Network, которая используется для создания зашифрованных подключений между двумя серверами, так и пользовательскими устройствами и серверами. Она позволяет защитить конфиденциальность данных и сохранить анонимность во время интернет-сессии.

- DPI  — технология Deep Packet Inspection для контроля пакетов данных на уровне приложений. Она позволяет проверять информацию и соотносить ее с определенными сервисами. Если приложение пытается скрыть свой трафик или демонстрирует подозрительное поведение, этот модуль NGFW отправляет уведомления ответственным лицам, благодаря чему чаще всего удается предотвратить инциденты информационной безопасности. Еще одна функция DPI — управление трафиком с целью оптимизировать нагрузку на локальную сеть. Модуль умеет приоритизировать пакеты данных, блокировать трафик от сомнительных и не используемых в работе приложений.

- Антивирус — компонент, способный обнаруживать вредоносное программное обеспечение различных типов. Он умеет в реальном времени оценивать безопасность интернет-ресурсов, автоматически анализировать все ссылки и файлы.

- Веб-прокси — компонент, который выполняет роль посредника между сервером и клиентом. Он позволяет расшифровывать и проверять трафик таких популярных протоколов, как HTTPS, повышая уровень безопасности интернет-сессий.

- Реверс-прокси — модуль NGFW, который отвечает за организацию безопасного доступа удаленных пользователей к внутренним веб-ресурсам компании.

- Категоризатор интернет-ресурсов — технология, позволяющая классифицировать сайты и страницы в зависимости от их содержимого. В основе ее работы могут лежать алгоритмы искусственного интеллекта и машинного обучения. Основная задача категоризатора — ограничение доступа к сомнительным и запрещенным законом ресурсам.
- Почтовая фильтрация — технология, позволяющая фильтровать письма, которые фигурируют в корпоративной электронной почте. Эта функция нужна для обнаружения спама, вредоносного ПО, а также для предотвращения утечек.

Отдельно стоит упомянуть про реализованный в Next Generation Firewall протокол ICAP. Он служит для интеграции файрвола нового поколения со сторонними решениями, тоже обеспечивающими сетевую защиту.

## Что умеет NGFW: функции и возможности
### Управление доступом по ролям и устройствам

Один из мощных инструментов — **гибкое управление доступом**, которое учитывает IP-адреса, **роли пользователей**, **тип устройств**. Это значит, что можно создать политику, по которой, например, сотрудники бухгалтерии смогут заходить в одни ресурсы, а инженеры — в другие, при этом с мобильных устройств будет действовать отдельное ограничение.

При такой модели управления можно точно контролировать, кто, когда, с какого устройства получает доступ к данным и снижать риски несанкционированного доступа.

### Поддержка политики Zero Trust

**Zero Trust** — это принцип «никому не доверяй, всегда проверяй». NGFW вписывается в эту концепцию: проверяет каждое соединение вне зависимости от того, происходит оно изнутри или извне сети.

Фаервол нового поколения способен оценивать много факторов перед тем, как пропустить трафик: от учетных данных и уровня устройства до поведения пользователя. Можно настроить архитектуру, где каждый доступ строго регламентирован, а вероятность бокового перемещения злоумышленника по сети минимальна.

### Защита от вредоносного ПО в реальном времени

NGFW анализирует трафик в потоке — то есть **в реальном времени**, не дожидаясь сигнала тревоги от антивируса или ручного анализа. Он может распознавать сигнатуры известных угроз, проверять поведение приложений, выявлять аномалии, блокировать подозрительные действия на лету.

В некоторых решениях присутствует даже интеграция с песочницами, sandboxing — изолированной средой, где можно безопасно запустить подозрительный файл и изучить его поведение. Это даёт защиту не только от известных угроз, но и от новых, ранее не встречавшихся атак.

### Контроль приложений (App Control)

С его помощью администраторы смогут **регулировать, как используются приложения**.

Например, NGFW может:

- разрешить вход в Zoom, но запретить передачу файлов через него
- блокировать YouTube в рабочее время, но оставить доступ к официальному каналу компании
- обнаруживать использование прокси или анонимайзеров.

Это особенно актуально в гибридных и распределённых средах, где сотрудники используют десятки SaaS-приложений.

### Защита облачных и гибридных инфраструктур

Современные NGFW умеют **работать не только на «железе», но и в облаке**. А это — защита данных и трафика даже в тех случаях, когда они проходят за пределами традиционного корпоративного периметра — например, в Yandex.Cloud.

Более того, межсетевой экран может быть развернут в виде виртуального устройства, которое контролирует взаимодействие между микросервисами или облачными зонами. Это особенно важно для гибридных архитектур, где часть систем работает локально, а часть — в облаке.

### Интеграция с SIEM, SOAR, другими системами

Эффективная безопасность невозможна без **централизованного анализа событий**. NGFW умеет передавать логи, события, данные об угрозах в системы класса **SIEM** (Security Information and Event Management) и **SOAR** (Security Orchestration, Automation and Response). Это дает возможность автоматически реагировать на инциденты, коррелировать события из разных источников, строить единую картину происходящего в инфраструктуре.

Интеграция файервола нового поколения с внешними системами превращает его в часть экосистемы кибербезопасности, где каждый компонент усиливает другой.

**В чем разница между функциями NGFW, шлюзов SWG и UTM**

Secure Web Gateway (сокращенно — SWG) — шлюзы безопасности с расширенной функциональностью. Они могут разграничивать права пользователей на доступ к веб-ресурсам, защищать от навязчивой рекламы и вредоносного программного обеспечения, ограничивать доступ к сомнительному контенту и т.д. Также SWG собирают данные, которые будут полезны при расследованиях инцидентов и планировании стратегии развития компании.

Unified Threat Management (сокращенно — UTM) — универсальные шлюзы, в которых реализовано несколько модулей, практически идентичных тем, что присутствуют в Next Generation Firewall. Но инструменты в таких решениях работают последовательно, то есть каждый начинает выполнять свои функции только после того, как закончит предыдущий.

Теперь об отличиях этих инструментов. Сначала существовали отдельные межсетевые экраны и прокси, затем их и другие механизмы защиты соединили в одно решение — UTM. Однако оно не отличалось высокой производительностью, поэтому прокси развили до шлюзов безопасности SWG. Затем технологии процессоров модернизировались, в связи с чем создатели комплексных защитных решений снова вернулись к UTM, усовершенствовали их и получили NGFW. То есть по факту главное отличие таких продуктов от UTM заключается в архитектуре.

Но некоторым компаниям все же недостаточно производительности NGFW, поэтому они используют межсетевые экраны нового поколения совместно с SWG. Речь о крупных организациях, которые располагают сложными сетями, несколькими филиалами и большим штатом сотрудников.

---
---
---
https://blog.infra-tech.ru/next-generation-firewall-review/?ysclid=mbdwndlw19352863185
https://www.securitylab.ru/analytics/559764.php
https://rt-solar.ru/products/solar_ngfw/blog/4289/?ysclid=mbdwckdqfh284343682
https://cloudnetworks.ru/inf-bezopasnost/ngfw/?ysclid=mbdwahs8hr112914893
https://habr.com/ru/companies/otus/articles/734770/